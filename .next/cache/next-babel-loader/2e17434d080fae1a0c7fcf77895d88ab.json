{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Windows\\\\Desktop\\\\housestreetcourse\\\\house-course\\\\src\\\\components\\\\searchBox.tsx\";\nimport usePlacesAutocomplete, { getGeocode, getLatLng } from \"use-places-autocomplete\";\nimport { useGoogleMapsScript } from \"use-google-maps-script\";\nimport { Combobox, ComboboxInput, ComboboxPopover, ComboboxList, ComboboxOption } from \"@reach/combobox\";\nimport \"@reach/combobox/styles.css\";\nconst libraries = [\"places\"];\nexport function SearchBox({\n  onSelectAddress,\n  defaultValue\n}) {\n  var _process$env$NEXT_PUB;\n\n  const {\n    isLoaded,\n    loadError\n  } = useGoogleMapsScript({\n    googleMapsApiKey: (_process$env$NEXT_PUB = process.env.NEXT_PUBLIC_FIREBASE_API_KEY) !== null && _process$env$NEXT_PUB !== void 0 ? _process$env$NEXT_PUB : \"\",\n    libraries\n  });\n  if (!isLoaded) return null;\n  if (loadError) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Error loading\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 25\n  }, this);\n  return /*#__PURE__*/_jsxDEV(ReadySearchBox, {\n    onSelectAddress: onSelectAddress,\n    defaultValue: defaultValue\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, this);\n}\n\nfunction ReadySearchBox({\n  onSelectAddress,\n  defaultValue\n}) {\n  const {\n    ready,\n    value,\n    setValue,\n    suggestions: {\n      status,\n      data\n    },\n    clearSuggestions\n  } = usePlacesAutocomplete({\n    debounce: 300,\n    defaultValue\n  });\n\n  const handleChange = e => {\n    setValue(e.target.value);\n\n    if (e.target.value === \"\") {\n      onSelectAddress(\"\", null, null);\n    }\n  };\n\n  const handleSelect = async address => {\n    setValue(address, false);\n    clearSuggestions();\n\n    try {\n      const results = await getGeocode({\n        address\n      });\n      const {\n        lat,\n        lng\n      } = await getLatLng(results[0]);\n      onSelectAddress(address, lat, lng);\n    } catch (error) {\n      console.error(`ðŸ˜± Error:`, error);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Combobox, {\n    onSelect: handleSelect,\n    children: [/*#__PURE__*/_jsxDEV(ComboboxInput, {\n      id: \"search\",\n      value: value,\n      onChange: handleChange,\n      disabled: !ready,\n      placeholder: \"Search your location\",\n      className: \"w-full p-2\",\n      autoComplete: \"off\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ComboboxPopover, {\n      children: /*#__PURE__*/_jsxDEV(ComboboxList, {\n        children: status === \"OK\" && data.map(({\n          place_id,\n          description\n        }) => /*#__PURE__*/_jsxDEV(ComboboxOption, {\n          value: description\n        }, place_id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 5\n  }, this);\n}","map":{"version":3,"sources":["C:/Users/Windows/Desktop/housestreetcourse/house-course/src/components/searchBox.tsx"],"names":["usePlacesAutocomplete","getGeocode","getLatLng","useGoogleMapsScript","Combobox","ComboboxInput","ComboboxPopover","ComboboxList","ComboboxOption","libraries","SearchBox","onSelectAddress","defaultValue","isLoaded","loadError","googleMapsApiKey","process","env","NEXT_PUBLIC_FIREBASE_API_KEY","ReadySearchBox","ready","value","setValue","suggestions","status","data","clearSuggestions","debounce","handleChange","e","target","handleSelect","address","results","lat","lng","error","console","map","place_id","description"],"mappings":"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","sourcesContent":["import { ChangeEvent } from \"react\";\r\nimport { FunctionComponent } from \"react\";\r\nimport usePlacesAutocomplete, {\r\n  getGeocode,\r\n  getLatLng,\r\n} from \"use-places-autocomplete\";\r\nimport { useGoogleMapsScript, Libraries } from \"use-google-maps-script\";\r\nimport {\r\n  Combobox,\r\n  ComboboxInput,\r\n  ComboboxPopover,\r\n  ComboboxList,\r\n  ComboboxOption,\r\n} from \"@reach/combobox\";\r\nimport \"@reach/combobox/styles.css\";\r\n\r\ninterface ISearchBoxProps {\r\n  onSelectAddress: (\r\n    address: string,\r\n    latitude: number | null,\r\n    longitude: number | null\r\n  ) => void;\r\n  defaultValue: string;\r\n}\r\n\r\nconst libraries: Libraries = [\"places\"];\r\n\r\nexport function SearchBox({ onSelectAddress, defaultValue }: ISearchBoxProps) {\r\n  const { isLoaded, loadError } = useGoogleMapsScript({\r\n    googleMapsApiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY ?? \"\",\r\n    libraries,\r\n  });\r\n\r\n  if (!isLoaded) return null;\r\n  if (loadError) return <div>Error loading</div>;\r\n\r\n  return (\r\n    <ReadySearchBox\r\n      onSelectAddress={onSelectAddress}\r\n      defaultValue={defaultValue}\r\n    />\r\n  );\r\n}\r\n\r\nfunction ReadySearchBox({ onSelectAddress, defaultValue }: ISearchBoxProps) {\r\n  const {\r\n    ready,\r\n    value,\r\n    setValue,\r\n    suggestions: { status, data },\r\n    clearSuggestions,\r\n  } = usePlacesAutocomplete({ debounce: 300, defaultValue });\r\n\r\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    setValue(e.target.value);\r\n    if (e.target.value === \"\") {\r\n      onSelectAddress(\"\", null, null);\r\n    }\r\n  };\r\n\r\n  const handleSelect = async (address: string) => {\r\n    setValue(address, false);\r\n    clearSuggestions();\r\n\r\n    try {\r\n      const results = await getGeocode({ address });\r\n      const { lat, lng } = await getLatLng(results[0]);\r\n      onSelectAddress(address, lat, lng);\r\n    } catch (error) {\r\n      console.error(`ðŸ˜± Error:`, error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Combobox onSelect={handleSelect}>\r\n      <ComboboxInput\r\n        id=\"search\"\r\n        value={value}\r\n        onChange={handleChange}\r\n        disabled={!ready}\r\n        placeholder=\"Search your location\"\r\n        className=\"w-full p-2\"\r\n        autoComplete=\"off\"\r\n      />\r\n      <ComboboxPopover>\r\n        <ComboboxList>\r\n          {status === \"OK\" &&\r\n            data.map(({ place_id, description }) => (\r\n              <ComboboxOption key={place_id} value={description} />\r\n            ))}\r\n        </ComboboxList>\r\n      </ComboboxPopover>\r\n    </Combobox>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}